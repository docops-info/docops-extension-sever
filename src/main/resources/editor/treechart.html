<!DOCTYPE html>
<html lang="en">
<head>
    <title>Charts Editor</title>
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
    <!-- CSS Reset -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
    <!-- Milligram CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://ajaxorg.github.io/ace-builds/src/ace.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.js"></script>

    <style>
        html, body { height: 100% }
        #editor, #return { height: 50% }
    </style>
</head>
<body>

<h1>TreeChart  Editor</h1>

<pre id="editor">
treeChart {
    name = "Product Range"
    child {
        name = "USB Converter"
        child {
            name = "USB 3.0 Converter"
        }
        child {
            name = "USB 2.0 Converter"
            child {
                name = "USB 2 Serial"
            }
            child {
                name = "USB 2 RS485"
            }
            child {
                name = "USB 2 Dual Serial"
            }
            child {
                name = "USB 2 MIDI"
            }
        }
    }
    child {
        name = "HDMI"
    }
}
</pre>


<script>
    let editor = ace.edit("editor");
    editor.setTheme("ace/theme/clouds");
    editor.session.setMode("ace/mode/kotlin");
    //editor.session.setMode("ace/mode/html");
    let successRes = function(data) {
        $('#return').empty().append(data);
    }
    // or use data: url to handle things like doctype
    function showHTMLInIFrame() {
        $.ajax({
            type: "POST",
            url: "/api/treechart",
            data: editor.getValue(),
            success: successRes,
            error: function( jqXhr, textStatus, errorThrown ){
                console.log( errorThrown );
            },
            dataType: "text"
        });

    }
    editor.on("input", showHTMLInIFrame);
</script>
<div id="return"></div>
</body>
</html>